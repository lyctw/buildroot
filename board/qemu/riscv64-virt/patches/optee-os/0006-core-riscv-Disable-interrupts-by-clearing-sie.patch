From 1f400a9566243aeb5f16c6473b5424c5529439ed Mon Sep 17 00:00:00 2001
From: Alvin Chang <alvinga@andestech.com>
Date: Tue, 5 Mar 2024 16:57:15 +0800
Subject: [PATCH 06/17] core: riscv Disable interrupts by clearing sie

Signed-off-by: Alvin Chang <alvinga@andestech.com>
---
 core/arch/riscv/kernel/thread_optee_abi_rv.S | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/core/arch/riscv/kernel/thread_optee_abi_rv.S b/core/arch/riscv/kernel/thread_optee_abi_rv.S
index e8ebba863..643861a8d 100644
--- a/core/arch/riscv/kernel/thread_optee_abi_rv.S
+++ b/core/arch/riscv/kernel/thread_optee_abi_rv.S
@@ -47,7 +47,7 @@ FUNC thread_std_abi_entry , :
 	mv	s0, a0
 
 	/* Disable all interrupts */
-	csrc	CSR_XSTATUS, CSR_XSTATUS_IE
+	csrw	CSR_XIE, x0
 
 	/* Switch to temporary stack */
 	jal	thread_get_tmp_sp
-- 
2.34.1

